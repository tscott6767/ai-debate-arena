<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>‚öîÔ∏è‚ÄØAI‚ÄØDebate‚ÄØArena</title>
  <style>
    body { background:#000; color:#0f9; font-family:'Courier New', monospace; margin:0; padding:20px; }
    h1 { text-align:center; }
    .panel { text-align:center; margin-bottom:15px; }
    input, select, button {
      background:#111; color:#0f9; border:1px solid #0f9; padding:6px 8px; font-size:1em; margin:3px;
    }
    #log {
      background:#001; border:1px solid #0f9; padding:15px; min-height:65vh;
      overflow-y:auto; white-space:pre-wrap;
    }
    .label { color:#aaa; margin-right:4px; }
  </style>
</head>
<body>
  <h1>‚öîÔ∏è‚ÄØAI‚ÄØDebate‚ÄØArena</h1>

  <div class="panel">
    <span class="label">Topic:</span>
    <input id="topic" placeholder="Enter debate topic" value="Should AI be open source?" size="60"><br>

    <span class="label">Rounds:</span>
    <input id="rounds" type="number" min="1" max="30" value="6" style="width:60px;">
  </div>

  <div class="panel">
    <b>Side‚ÄØA</b><br>
    <label class="label">Provider:</label>
    <select id="providerA" onchange="loadModels('A')"></select>
    <label class="label">Model:</label>
    <select id="modelA"></select>
  </div>

  <div class="panel">
    <b>Side‚ÄØB</b><br>
    <label class="label">Provider:</label>
    <select id="providerB" onchange="loadModels('B')"></select>
    <label class="label">Model:</label>
    <select id="modelB"></select>
  </div>

  <div class="panel">
    <b>Judge</b><br>
    <label class="label">Provider:</label>
    <select id="providerJudge" onchange="loadModels('Judge')"></select>
    <label class="label">Model:</label>
    <select id="modelJudge"></select>
  </div>

  <div class="panel">
    <button onclick="startDebate()">START‚ÄØDEBATE</button>
  </div>

  <div id="log"></div>

  <script>
    // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    // Fetch provider‚Üímodel map & load dropdowns
    // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    async function loadProviders() {
      const res = await fetch('/api/models');
      const data = await res.json();
      const allProviders = Object.keys(data);
      ['A','B','Judge'].forEach(side=>{
        const sel = document.getElementById(`provider${side}`);
        sel.innerHTML = "";
        allProviders.forEach(p=>{
          const opt = document.createElement("option");
          opt.value = p; opt.textContent = p;
          sel.appendChild(opt);
        });
        loadModels(side);  // load default model list
      });
    }

    async function loadModels(side) {
      const provider = document.getElementById(`provider${side}`).value;
      const res = await fetch(`/api/models?provider=${provider}`);
      const js = await res.json();
      const sel = document.getElementById(`model${side}`);
      sel.innerHTML = "";
      (js.models || []).forEach(m=>{
        const opt=document.createElement("option");
        opt.value=m; opt.textContent=m;
        sel.appendChild(opt);
      });
    }

    // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    // Debate starter
    // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    let ws=null;
    function startDebate(){
      if(ws) ws.close();
      const topic=document.getElementById('topic').value||"Default topic";
      const rounds=document.getElementById('rounds').value;

      const pa=document.getElementById('providerA').value;
      const ma=document.getElementById('modelA').value;
      const pb=document.getElementById('providerB').value;
      const mb=document.getElementById('modelB').value;
      const pj=document.getElementById('providerJudge').value;
      const mj=document.getElementById('modelJudge').value;

      const url=`ws://${location.host}/ws/debate?topic=${encodeURIComponent(topic)}&rounds=${rounds}`
               +`&provider_a=${pa}&model_a=${ma}`
               +`&provider_b=${pb}&model_b=${mb}`
               +`&judge_provider=${pj}&judge_model=${mj}`;
      ws=new WebSocket(url);

      const log=document.getElementById('log');
      log.textContent="";
      ws.onmessage=(e)=>{ log.insertAdjacentText("beforeend",e.data); log.scrollTop=log.scrollHeight; };
      ws.onclose = ()=> log.insertAdjacentText("beforeend","\n\nüîí‚ÄØConnection closed.\n");
      ws.onerror = ()=> log.insertAdjacentText("beforeend","\n\n‚ùå‚ÄØWebSocket error.\n");
    }

    // initialize dropdowns at page load
    loadProviders();
  </script>
</body>
</html>

